# Configuration globale des chunks
knitr::opts_chunk$set(
echo = TRUE,              # Afficher le code
warning = FALSE,          # Masquer les warnings
message = FALSE,          # Masquer les messages
fig.align = "center",     # Centrer les figures
fig.width = 10,           # Largeur des figures
fig.height = 6,
out.width = "80%",
cache = FALSE
)
library(ggplot2)
library(dplyr)
mean_w <- function(df){
mean_1 <- sum(df[,1]*df[,2])/sum(df[,2])
mean_2 <- sum(df[,1]*df[,3])/sum(df[,3])
var_w_1 <- sqrt(1/500 * sum((df[,1]-mean_1)**2))
var_w_2 <- sqrt(1/500 * sum((df[,1]-mean_2)**2))
prop_w_1 <- 1/500 * sum(df[,2])
prop_w_2 <- 1/500 * sum(df[,3])
return(c(mean_1,mean_2,var_w_1,var_w_2,prop_w_1,prop_w_2))
}
# test
theta <- mean_w(df)
# Création d'un data frame
df <- data.frame(values = vec_4)
# Configuration globale des chunks
knitr::opts_chunk$set(
echo = TRUE,              # Afficher le code
warning = FALSE,          # Masquer les warnings
message = FALSE,          # Masquer les messages
fig.align = "center",     # Centrer les figures
fig.width = 10,           # Largeur des figures
fig.height = 6,
out.width = "80%",
cache = FALSE
)
library(ggplot2)
library(dplyr)
mu_1 = 12.74
mu_2 = 23.92
sigma_1 = 5
sigma_2 = 7.3
prop_1 = 350/500
prop_2 = 150/500
vec_4_1 <- rnorm(350, mu_1, sigma_1)
vec_4_2 <- rnorm(150, mu_2, sigma_2)
vec_4 <- c(vec_4_1,vec_4_2)
vec_4 <- sample(vec_4)
#Pour l'exportation
#write.csv(vec_4, "vecteur_4.csv")
# Création d'un data frame
df <- data.frame(values = vec_4)
# Plot de densité
ggplot(df, aes(x = values)) +
geom_density(fill = "blue", alpha = 0.5, color = "black") +
geom_vline(aes(xintercept = mu_1), color = "chartreuse3", linetype = "dashed", size = 1) +
geom_vline(aes(xintercept = mu_2), color = "coral3", linetype = "dashed", size = 1) +
labs(title = "Plot de densité de vec_4",
x = "Valeurs",
y = "Densité") +
theme_minimal() +
annotate("text", x = mu_1, y = 0.04, label = paste("mu 1 (", mu_1, ")", sep = ""), color = "chartreuse3") +
annotate("text", x = mu_2, y = 0.04, label = paste("mu 2 (", mu_2, ")", sep = ""), color = "coral3")
# Création d'un data frame
df <- data.frame(values = vec_4)
# Plot de densité
ggplot(df, aes(x = values)) +
geom_density(fill = "blue", alpha = 0.5, color = "black") +
geom_vline(aes(xintercept = mu_1), color = "darkolivegreen", linetype = "dashed", size = 1) +
geom_vline(aes(xintercept = mu_2), color = "firebrick4", linetype = "dashed", size = 1) +
labs(title = "Plot de densité de notre vecteur",
x = "Valeurs",
y = "Densité") +
theme_minimal() +
annotate("text", x = mu_1, y = 0.04, label = paste("mu 1 (", mu_1, ")", sep = ""), color = "darkolivegreen") +
annotate("text", x = mu_2, y = 0.04, label = paste("mu 2 (", mu_2, ")", sep = ""), color = "firebrick4")
# Création d'un data frame
df <- data.frame(values = vec_4)
# Plot de densité
ggplot(df, aes(x = values)) +
geom_density(fill = "blue", alpha = 0.5, color = "black") +
geom_vline(aes(xintercept = mu_1), color = "darkolivegreen4", linetype = "dashed", size = 1) +
geom_vline(aes(xintercept = mu_2), color = "firebrick4", linetype = "dashed", size = 1) +
labs(title = "Plot de densité de notre vecteur",
x = "Valeurs",
y = "Densité") +
theme_minimal() +
annotate("text", x = mu_1, y = 0.04, label = paste("mu 1 (", mu_1, ")", sep = ""), color = "darkolivegreen4") +
annotate("text", x = mu_2, y = 0.04, label = paste("mu 2 (", mu_2, ")", sep = ""), color = "firebrick4")
# Création d'un data frame
df <- data.frame(values = vec_4)
# Plot de densité
ggplot(df, aes(x = values)) +
geom_density(fill = "blue", alpha = 0.5, color = "black") +
geom_vline(aes(xintercept = mu_1), color = "darkolivegreen", linetype = "dashed", size = 1) +
geom_vline(aes(xintercept = mu_2), color = "firebrick4", linetype = "dashed", size = 1) +
labs(title = "Plot de densité de notre vecteur",
x = "Valeurs",
y = "Densité") +
theme_minimal() +
annotate("text", x = mu_1, y = 0.04, label = paste("mu 1 (", mu_1, ")", sep = ""), color = "darkolivegreen") +
annotate("text", x = mu_2, y = 0.04, label = paste("mu 2 (", mu_2, ")", sep = ""), color = "firebrick4")
# Création d'un data frame
df <- data.frame(values = vec_4)
# Plot de densité
ggplot(df, aes(x = values)) +
geom_density(fill = "grey", alpha = 0.5, color = "black") +
geom_vline(aes(xintercept = mu_1), color = "red", linetype = "dashed", size = 1) +
geom_vline(aes(xintercept = mu_2), color = "blue", linetype = "dashed", size = 1) +
labs(title = "Plot de densité de notre vecteur",
x = "Valeurs",
y = "Densité") +
theme_minimal() +
annotate("text", x = mu_1, y = 0.04, label = paste("mu 1 (", mu_1, ")", sep = ""), color = "red") +
annotate("text", x = mu_2, y = 0.04, label = paste("mu 2 (", mu_2, ")", sep = ""), color = "blue")
set.seed(100)
vect1 = sample(c(rnorm(250,mean=2,sd=1),rnorm(250,mean=10,sd=1.5)))
# Création d'un data frame
df <- data.frame(values = vect1)
# Plot de densité
ggplot(df, aes(x = values)) +
geom_density(fill = "blue", alpha = 0.5, color = "black")  +
labs(title = "Plot de densité du vecteur du groupe 1",
x = "Valeurs",
y = "Densité") +
theme_minimal()
proba_10 <- 1 / (5 * sqrt(2 * pi)) * exp(-1/2 * ((7 - 10) / 5)^2)
proba_2 <-1 / (5 * sqrt(2 * pi)) * exp(-1/2 * ((7 - 2) / 5)^2)
proba_2
C_1 <-(proba_10 *250/500)/ (proba_10*250/500+proba_2*1/2)
C_1
C_2 <-(proba_2 *250/500)/ (proba_10*250/500+proba_2*1/2)
C_2
proba_10_2 <- 1 / (5 * sqrt(2 * pi)) * exp(-1/2 * ((2 - 10) / 5)^2)
proba_10_2
proba_2_2 <-1 / (5 * sqrt(2 * pi)) * exp(-1/2 * ((2 - 2) / 5)^2)
proba_2_2
C_1_2 <-(proba_10_2 *250/500)/ (proba_10_2*250/500+proba_2_2*1/2)
C_1_2
C_2_2 <-(proba_2 *250/500)/ (proba_10*250/500+proba_2*1/2)
C_2_2
proba_10_10 <- 1 / (5 * sqrt(2 * pi)) * exp(-1/2 * ((10 - 10) / 5)^2)
proba_10_10
proba_2_10 <-1 / (5 * sqrt(2 * pi)) * exp(-1/2 * ((10 - 2) / 5)^2)
proba_2_10
C_1_10 <-(proba_10_10 *250/500)/ (proba_10_10*250/500+proba_2_10*1/2)
C_1_10
C_2_10 <-(proba_2_10 *250/500)/ (proba_10_10*250/500+proba_2_10*1/2)
C_2_10
df <- as.data.frame(matrix(0, nrow = 500, ncol = 3))
for (i in seq_along(vect1)) {
df[i,1] <- vect1[i]
df[i,2] <- proba_appart(vect1[i],10, 5,2,5,1/2,1/2)[1]
df[i,3] <- proba_appart(vect1[i],10, 5,2,5,1/2,1/2)[2]
}
# Fonction de la proba d'appartenance
proba_appart <- function(x, mu1, sigma1,mu2,sigma2, p1, p2){
proba_grp_1 <- 1 / (sigma1 * sqrt(2 * pi)) * exp(-1/2 * ((x - mu1) / sigma1)^2)
proba_grp_2 <- 1 / (sigma2 * sqrt(2 * pi)) * exp(-1/2 * ((x - mu2) / sigma2)^2)
C_1 <-(proba_grp_1 *p1)/ (proba_grp_1*p1+proba_grp_2*p2)
C_2 <- (proba_grp_2 *p2)/ (proba_grp_1*p1+proba_grp_2*p2)
return(c(C_1,C_2))}
#test
pb<-proba_appart(2,10, 5,2,5,1/2,1/2)
pb[2]
df <- as.data.frame(matrix(0, nrow = 500, ncol = 3))
for (i in seq_along(vect1)) {
df[i,1] <- vect1[i]
df[i,2] <- proba_appart(vect1[i],10, 5,2,5,1/2,1/2)[1]
df[i,3] <- proba_appart(vect1[i],10, 5,2,5,1/2,1/2)[2]
}
df
df <- as.data.frame(matrix(0, nrow = 500, ncol = 3))
for (i in seq_along(vect1)) {
df[i,1] <- vect1[i]
df[i,2] <- proba_appart(vect1[i],10, 5,2,5,1/2,1/2)[1]
df[i,3] <- proba_appart(vect1[i],10, 5,2,5,1/2,1/2)[2]
}
head(df)
df <- as.data.frame(matrix(0, nrow = 500, ncol = 3))
for (i in seq_along(vect1)) {
df[i,1] <- vect1[i]
df[i,2] <- proba_appart(vect1[i],10, 5,2,5,1/2,1/2)[1]
df[i,3] <- proba_appart(vect1[i],10, 5,2,5,1/2,1/2)[2]
}
df<-t(df)
head(df)
df
t(df)
df
df <- as.data.frame(matrix(0, nrow = 500, ncol = 3))
for (i in seq_along(vect1)) {
df[i,1] <- vect1[i]
df[i,2] <- proba_appart(vect1[i],10, 5,2,5,1/2,1/2)[1]
df[i,3] <- proba_appart(vect1[i],10, 5,2,5,1/2,1/2)[2]
}
df<-t(df)
df
t(df)
df
#On doit transposer notre df pour des raisons de bonne pratique
df<-t(df)
mean_w <- function(df){
mean_1 <- sum(df[,1]*df[,2])/sum(df[,2])
mean_2 <- sum(df[,1]*df[,3])/sum(df[,3])
var_w_1 <- sqrt(1/500 * sum((df[,1]-mean_1)**2))
var_w_2 <- sqrt(1/500 * sum((df[,1]-mean_2)**2))
prop_w_1 <- 1/500 * sum(df[,2])
prop_w_2 <- 1/500 * sum(df[,3])
return(c(mean_1,mean_2,var_w_1,var_w_2,prop_w_1,prop_w_2))
}
# test
theta <- mean_w(df)
theta
log_likelihood <- function(df, mu1, sigma1, mu2, sigma2, p1, p2) {
ll <- sum(log(p1 * dnorm(df$x, mean = mu1, sd = sigma1) + p2 * dnorm(df$x, mean = mu2, sd = sigma2)))
return(ll)
}
